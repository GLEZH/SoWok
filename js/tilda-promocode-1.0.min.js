function t_input_promocode_init(o,t){var e,r,a=document.querySelector("#rec"+o).querySelector('[data-input-lid="'+t+'"]');a&&(e=a.querySelector(".t-inputpromocode"),r=a.querySelector(".t-inputpromocode__btn"),e.setAttribute("autocomplete",0<navigator.userAgent.search(/Chrome/)?"no":"off"),e.addEventListener("focus",function(){r.style.display="table-cell"}),r.addEventListener("click",function(){t_input_promocode__applyPromoCode(a,e,r)}))}function t_input_promocode__applyPromoCode(r,o,a){var t,i,e=o.value;e?(o={promocode:e,projectid:(t=document.querySelector("#allrecords")).getAttribute("data-tilda-project-id")},(o=new FormData).append("promocode",e),o.append("projectid",t.getAttribute("data-tilda-project-id")),o.has("projectid")?"edit"!==(t=t.getAttribute("data-tilda-mode"))||"preview"!==t?window.t_promocode_load&&"y"===window.t_promocode_load||(window.t_promocode_load="y",a.classList.add("t-btn_sending"),(i=new XMLHttpRequest).open("POST","https://forms.tildacdn.com/payment/promocode/",!0),i.onload=function(){if(200<=i.status&&i.status<400){delete window.t_promocode_load,a.classList.remove("t-btn_sending");var o=i.responseText;if(o){var t=JSON.parse(o);if("object"==typeof t)if(t.message&&"OK"===t.message){var e="";if(e+='<div style="font-weight:600;" class="t-text">'+t_input_promocode__getLangText("promocode")+" ",e+=t.promocode,e+=" "+t_input_promocode__getLangText("activated")+".<br>"+t_input_promocode__getLangText("discount")+": ",t.discountsum&&0<t.discountsum)if("object"==typeof window.tcart)try{"function"==typeof tcart__showPrice&&(e+=tcart__showPrice(t.discountsum))}catch(o){}else e+=t.discountsum;t.discountpercent&&0<t.discountpercent&&(e+=parseFloat(t.discountpercent)+"%"),e+="</div>",r.querySelector(".t-inputpromocode__wrapper").innerHTML=e;try{t_onFuncLoad("tcart__addPromocode",function(){tcart__addPromocode(t)})}catch(o){}}else t.error&&t.error?alert(t.error):alert("Promo code activation some error.");else alert("Promo code activation error. Bad answer from server")}else alert("Promo code activation error. Empty answer from server")}else delete window.t_promocode_load,a.classList.remove("t-btn_sending"),alert("Request status error "+i.status)},i.onerror=function(){delete window.t_promocode_load,a.classList.remove("t-btn_sending"),alert("Request timeout error (activate promo code)")},i.send(o)):alert(t_input_promocode__getLangText("publish")):alert(t_input_promocode__getLangText("badprojectid"))):console.log("Promo code is empty")}function t_input_promocode__getLangText(o){var t=[];t.publish={EN:"Please, publish the page, to test promo code activation functionality",RU:"Пожалуйста, опубликуйте страницу, чтобы проверить функциональность активации промокода",FR:"S'il vous plaît, publier la page, pour tester la fonctionnalité d'activation promo de code",DE:"Bitte veröffentlichen Sie die Seite, um Testgutscheincode Aktivierung Funktionalität",ES:"Por favor, publicar la página, a la funcionalidad de activación código promocional prueba",PT:"Por favor, publicar a página, a funcionalidade de ativação código de teste promo",UK:"Будь ласка, опублікуйте сторінку, щоб перевірити функціональність активації промокоду",JA:"、テスト用プロモーションコードのアクティベーション機能に、ページを公開してください。",ZH:"请发布页面，测试促销代码激活功能",PL:"Opublikuj stronę, aby przetestować funkcjonalność aktywacji kodu promocyjnego",KK:"Промокодты іске қосу функциясын тексеру үшін бетті жариялаңыз",IT:"Si prega, pubblicare la pagina, alla funzionalità il codice di attivazione di prova promozionale`",LV:"Lūdzu, publicējiet lapu, lai testa promo kodu aktivizācijas funkcionalitāti"},t.badprojectid={EN:"Promo code activation error. Bad projectid",RU:"Ошибка активации промокода. Некорректный projectid",FR:"Promo Erreur d'activation de code. Bad projectId",DE:"Promo Code Aktivierungsfehler. Bad projectid",ES:"Error de activación de código promocional. Mala projectId",PT:"Promo erro de ativação código. Bad projectId",UK:"Помилка активації промокоду. Поганий projectid",JA:"プロモーションコードのアクティブ化エラー。悪い projectid",ZH:"促销代码激活错误。坏专案编号",PL:"Błąd aktywacji kodu promocyjnego. Bad projectid",KK:"Промокодты белсендіру қатесі. Нашар projectid",IT:"Errore di attivazione codice promozionale. Bad projectid",LV:"Promo kods aktivizācijas kļūda. Bad projectid"},t.promocode={EN:"Promo code",RU:"Промокод",FR:"Code promo",DE:"Gutscheincode",ES:"Código promocional",PT:"Código promocional",UK:"Промокод",JA:"プロモーションコード",ZH:"促销代码",PL:"Kod rabatowy",KK:"Промокод",IT:"Codice promozionale",LV:"Promo kods"},t.activated={EN:"has been activated",RU:"активирован",FR:"a été activé",DE:"wurde aktiviert",ES:"Ha sido activado",PT:"Foi ativado",UK:"активований",JA:"活性化されています",ZH:"已被激活",PL:"został aktywowany",KK:"болды белсендірілді",IT:"è stato attivato",LV:"ir aktivizēta"},t.discount={EN:"Your discount",RU:"Ваша скидка",FR:"votre remise",DE:"Ihr Rabatt",ES:"su descuento",PT:"seu desconto",UK:"Ваша знижка",JA:"あなたの割引",ZH:"您的折扣",PL:"Twój rabat",KK:"Сіздің жеңілдік",IT:"Lo sconto",LV:"Jūsu atlaide"};var e=window.browserLang;return t[o]?t[o][e]||t[o].EN:"Text not found #"+o}
